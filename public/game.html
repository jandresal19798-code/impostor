<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üïµÔ∏è</text></svg>">
    <title>üïµÔ∏è El Impostor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', -apple-system, sans-serif; }
        
        body {
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(120, 50, 50, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(80, 50, 120, 0.15) 0%, transparent 50%),
                linear-gradient(135deg, #0b0f1a 0%, #1a1f35 50%, #0b0f1a 100%);
            background-attachment: fixed;
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            color: white;
            min-height: 100vh;
        }

        .hidden { display: none !important; }

        /* Main Card Container */
        .game-card {
            background: rgba(15, 20, 35, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 2rem;
            box-shadow: 
                0 0 0 1px rgba(255,255,255,0.05),
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 100px -20px rgba(239, 68, 68, 0.1);
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent, 
                #ef4444, 
                #f97316, 
                #ef4444, 
                transparent);
            background-size: 200% 100%;
            animation: gradient-shift 3s linear infinite;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        /* Neon Button Styles (uiverse inspired) */
        .neon-btn {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #fff;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border: none;
            border-radius: 1rem;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 
                0 4px 15px rgba(239, 68, 68, 0.3),
                0 0 30px rgba(239, 68, 68, 0.1);
        }

        .neon-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(255,255,255,0.1),
                transparent
            );
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .neon-btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(239, 68, 68, 0.4),
                0 0 50px rgba(239, 68, 68, 0.2);
        }

        .neon-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .neon-btn span {
            position: relative;
            z-index: 1;
        }

        /* Border Neon Button */
        .neon-border-btn {
            position: relative;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #94a3b8;
            background: transparent;
            border: 2px solid rgba(148, 163, 184, 0.3);
            border-radius: 1rem;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .neon-border-btn::before,
        .neon-border-btn::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ef4444;
            transition: all 0.3s ease;
        }

        .neon-border-btn::before {
            top: -2px;
            left: -2px;
            border-radius: 50% 0 0 0;
        }

        .neon-border-btn::after {
            bottom: -2px;
            right: -2px;
            border-radius: 0 0 50% 0;
        }

        .neon-border-btn:hover {
            color: #fff;
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow: 
                inset 0 0 20px rgba(239, 68, 68, 0.1),
                0 0 20px rgba(239, 68, 68, 0.2);
        }

        .neon-border-btn:hover::before,
        .neon-border-btn:hover::after {
            width: calc(100% + 4px);
            height: calc(100% + 4px);
            border-radius: 0.5rem;
        }

        /* Category Buttons */
        .category-btn {
            position: relative;
            padding: 0.5rem 0.25rem;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #64748b;
            background: rgba(30, 35, 50, 0.8);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .category-btn.active {
            color: #fff;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-color: transparent;
            box-shadow: 
                0 4px 15px rgba(239, 68, 68, 0.4),
                0 0 30px rgba(239, 68, 68, 0.2);
        }

        .category-btn:hover:not(.active) {
            color: #94a3b8;
            background: rgba(40, 45, 65, 0.9);
            border-color: rgba(255,255,255,0.1);
        }

        /* Animated Input (uiverse style) */
        .neon-input {
            position: relative;
            width: 100%;
        }

        .neon-input input {
            width: 100%;
            padding: 0.875rem 1rem;
            font-size: 0.95rem;
            color: #fff;
            background: rgba(20, 25, 40, 0.8);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 0.75rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .neon-input input::placeholder {
            color: #4b5563;
        }

        .neon-input input:focus {
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow: 
                0 0 0 3px rgba(239, 68, 68, 0.1),
                0 0 20px rgba(239, 68, 68, 0.1);
        }

        .neon-input::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ef4444, transparent);
            transform: translateX(-50%);
            transition: width 0.3s ease;
        }

        .neon-input:focus-within::before {
            width: 80%;
        }

        /* Player Remove Button */
        .remove-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(30, 35, 50, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 0.75rem;
            color: #64748b;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
        }

        /* Impostor Count Buttons */
        .count-btn {
            width: 2.25rem;
            height: 2.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 700;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(30, 35, 50, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            color: #64748b;
        }

        .count-btn.active {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-color: transparent;
            color: #fff;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .count-btn:hover:not(.active) {
            background: rgba(50, 55, 75, 0.9);
            border-color: rgba(255,255,255,0.2);
        }

        /* Word Reveal Card */
        .word-card {
            background: linear-gradient(145deg, rgba(15, 20, 35, 0.9) 0%, rgba(25, 30, 50, 0.9) 100%);
            border: 2px solid rgba(239, 68, 68, 0.2);
            border-radius: 1.5rem;
            box-shadow: 
                0 0 30px rgba(239, 68, 68, 0.1),
                inset 0 0 30px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .word-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(239, 68, 68, 0.1) 0%, transparent 50%);
            animation: pulse-rotate 4s linear infinite;
        }

        @keyframes pulse-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .word-card.impostor {
            border-color: rgba(239, 68, 68, 0.5);
            animation: impostor-glow 1.5s ease-in-out infinite;
        }

        @keyframes impostor-glow {
            0%, 100% { box-shadow: 0 0 30px rgba(239, 68, 68, 0.2); }
            50% { box-shadow: 0 0 50px rgba(239, 68, 68, 0.4); }
        }

        /* Floating Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .animate-float { animation: float 3s ease-in-out infinite; }

        /* Timer Progress */
        .timer-progress {
            background: linear-gradient(90deg, #ef4444 0%, #f97316 50%, #ef4444 100%);
            background-size: 200% 100%;
            animation: gradient-scroll 2s linear infinite;
        }

        @keyframes gradient-scroll {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        /* Voting Card */
        .vote-card {
            background: linear-gradient(135deg, rgba(30, 35, 55, 0.8) 0%, rgba(20, 25, 40, 0.8) 100%);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 0.75rem;
            padding: 0.875rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vote-card:hover {
            background: linear-gradient(135deg, rgba(50, 55, 80, 0.9) 0%, rgba(35, 45, 65, 0.9) 100%);
            border-color: rgba(239, 68, 68, 0.3);
            transform: translateX(4px);
        }

        .vote-card.voted {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2) 0%, rgba(22, 101, 52, 0.2) 100%);
            border-color: rgba(34, 197, 94, 0.3);
        }

        .vote-card .voted-badge {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Result Card */
        .result-card {
            background: linear-gradient(145deg, rgba(25, 30, 50, 0.95) 0%, rgba(15, 20, 35, 0.95) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 1rem;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(239, 68, 68, 0.3);
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.5);
        }

        /* Player name display */
        .player-name {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%);
            border: 1px solid rgba(239, 68, 68, 0.2);
            animation: name-glow 2s ease-in-out infinite;
        }

        @keyframes name-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.1); }
            50% { box-shadow: 0 0 40px rgba(239, 68, 68, 0.2); }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="confetti-container" class="fixed inset-0 pointer-events-none z-50 overflow-hidden"></div>
    
    <div class="game-card w-full max-w-md p-8 relative">
        
        <!-- Pantalla de Inicio -->
        <div id="screen-setup" class="space-y-6">
            <div class="text-center">
                <div class="inline-block animate-float mb-4">
                    <span class="text-6xl">üïµÔ∏è</span>
                </div>
                <h1 class="text-4xl font-black tracking-tight text-white mb-2">IMPOSTOR</h1>
                <p class="text-slate-400 text-sm">Descubre al impostor entre nosotros</p>
            </div>

            <div class="grid grid-cols-4 gap-2 p-1.5 bg-slate-900/50 rounded-xl">
                <button onclick="selectCategory('general')" id="cat-general" class="category-btn active">GENERAL</button>
                <button onclick="selectCategory('peliculas')" id="cat-peliculas" class="category-btn">PEL√çCULAS</button>
                <button onclick="selectCategory('paises')" id="cat-paises" class="category-btn">PA√çSES</button>
                <button onclick="selectCategory('comida')" id="cat-comida" class="category-btn">COMIDA</button>
                <button onclick="selectCategory('tecnologia')" id="cat-tecnologia" class="category-btn">TECNO</button>
                <button onclick="selectCategory('deportes')" id="cat-deportes" class="category-btn">DEPORTES</button>
                <button onclick="selectCategory('animales')" id="cat-animales" class="category-btn">ANIMALES</button>
                <button onclick="selectCategory('colores')" id="cat-colores" class="category-btn">COLORES</button>
            </div>

            <div id="names-container" class="space-y-3 max-h-52 overflow-y-auto pr-2">
            </div>

            <div class="flex gap-2">
                <button onclick="addPlayerInput()" class="neon-border-btn flex-1">
                    + AGREGAR JUGADOR
                </button>
                <button onclick="removeLastPlayer()" class="neon-border-btn px-4">
                    ‚àí
                </button>
            </div>

            <div class="bg-slate-900/50 p-4 rounded-xl">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-xs text-slate-400 font-medium uppercase tracking-wider">IMPOSTORES</span>
                    <div class="flex-1 h-px bg-slate-700"></div>
                </div>
                <div class="flex gap-2 justify-center" id="impostor-count">
                    <button onclick="setImpostorCount(1)" class="count-btn active">1</button>
                    <button onclick="setImpostorCount(2)" class="count-btn">2</button>
                    <button onclick="setImpostorCount(3)" class="count-btn">3</button>
                </div>
            </div>

            <button onclick="initGame()" class="neon-btn w-full py-4 text-lg">
                <span>üéÆ COMENZAR</span>
            </button>
        </div>

        <!-- Pantalla de Transici√≥n -->
        <div id="screen-transition" class="hidden text-center space-y-6 py-8">
            <div class="space-y-4">
                <div class="w-20 h-20 mx-auto rounded-full bg-slate-900/50 flex items-center justify-center border border-red-500/20">
                    <span class="text-4xl">üì±</span>
                </div>
                <p class="text-slate-500 uppercase tracking-widest text-xs font-bold">Pas√° el tel√©fono a</p>
                <div id="current-player-name" class="player-name text-4xl font-black text-white px-4 py-6 rounded-2xl animate-float">
                    NOMBRE
                </div>
                <p id="player-counter" class="text-slate-500 text-sm">Jugador 1 de 5</p>
            </div>
            <button onclick="revealRole()" class="neon-btn w-full py-4">
                <span>üëÅÔ∏è VER MI ROL</span>
            </button>
        </div>

        <!-- Pantalla de Revelaci√≥n -->
        <div id="screen-reveal" class="hidden text-center space-y-6 py-8">
            <p class="text-red-500 font-bold uppercase tracking-widest text-xs">Tu palabra es</p>
            <div id="secret-word" class="word-card text-3xl font-black text-white py-16 px-4 relative">
                ---
            </div>
            <div id="role-indicator" class="hidden px-4 py-2 rounded-lg font-bold text-sm"></div>
            <button onclick="nextStep()" class="neon-btn w-full py-4">
                <span>‚úÖ YA LA VI</span>
            </button>
        </div>

        <!-- Pantalla de Juego -->
        <div id="screen-playing" class="hidden text-center space-y-6 py-8">
            <div class="inline-block animate-float">
                <span class="text-7xl">üïµÔ∏è‚Äç‚ôÇÔ∏è</span>
            </div>
            <h2 class="text-2xl font-black uppercase text-white">¬°A DEBATIR!</h2>
            
            <div class="bg-slate-900/50 p-4 rounded-xl text-left text-sm text-slate-300 space-y-2">
                <p class="flex items-start gap-2"><span class="text-red-500">‚Ä¢</span> Dec√≠ una palabra relacionada</p>
                <p class="flex items-start gap-2"><span class="text-red-500">‚Ä¢</span> El impostor debe pasar desapercibido</p>
                <p class="flex items-start gap-2"><span class="text-red-500">‚Ä¢</span> ¬°Encontr√° al mentiroso!</p>
            </div>

            <div class="bg-slate-900/50 p-4 rounded-xl space-y-3">
                <div class="flex justify-between items-center">
                    <span class="text-xs text-slate-400 uppercase tracking-wider">TIEMPO</span>
                    <span id="timer-display" class="text-2xl font-black text-red-500">2:00</span>
                </div>
                <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div id="timer-bar" class="h-full timer-progress rounded-full" style="width: 100%"></div>
                </div>
                <button onclick="toggleTimer()" id="timer-btn" class="w-full py-2 rounded-lg bg-slate-800 text-white text-sm font-bold hover:bg-slate-700 transition">
                    ‚è∏Ô∏è PAUSAR
                </button>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <button onclick="startVoting()" class="neon-btn py-3 text-sm">
                    üó≥Ô∏è VOTAR
                </button>
                <button onclick="resetGame()" class="neon-border-btn py-3 text-sm">
                    üîÑ NUEVA PARTIDA
                </button>
            </div>
        </div>

        <!-- Pantalla de Votaci√≥n -->
        <div id="screen-voting" class="hidden text-center space-y-6 py-8">
            <h2 class="text-xl font-black uppercase">¬øQUI√âN ES EL IMPOSTOR?</h2>
            <p class="text-slate-500 text-xs">Toc√° para votar</p>
            <div id="voting-players" class="space-y-2 max-h-64 overflow-y-auto">
            </div>
            <button onclick="backToGame()" class="neon-border-btn w-full py-3">
                VOLVER AL JUEGO
            </button>
        </div>

        <!-- Pantalla de Resultados -->
        <div id="screen-results" class="hidden text-center space-y-6 py-8">
            <div class="inline-block animate-float text-8xl" id="result-emoji">üéâ</div>
            <h2 id="result-title" class="text-2xl font-black uppercase">¬°RESULTADOS!</h2>
            <div id="result-content" class="result-card p-4 rounded-xl text-left text-sm space-y-2">
            </div>
            <button onclick="resetGame()" class="neon-btn w-full py-4">
                <span>üîÑ JUGAR DE NUEVO</span>
            </button>
        </div>

    </div>

    <script>
        const wordBank = {
            general: ["Pizza", "Par√≠s", "iPhone", "F√∫tbol", "Elefante", "Netflix", "Guitarra", "Dinosaurio", "Chocolate", "Tibur√≥n", "Espada", "Marte", "Cine", "Hamburguesa", "Avi√≥n", "Batman", "Zombi", "Minecraft", "Sushi", "Playa", "Robot", "Nube", "Fuego", "Hielo", "Luna", "Sol", "Estrella", "Tel√©fono", "Reloj", "Cerveza", "Gato", "Perro", "P√°jaro", "Coche", "Casa", "Libro", "Agua", "Tierra", "Viento", "M√∫sica", "Danza"],
            peliculas: ["Matrix", "Titanic", "Avatar", "Gladiador", "Frozen", "Toy Story", "Jurassic Park", "El Rey Le√≥n", "Volver al Futuro", "Star Wars", "Harry Potter", "El Se√±or de los Anillos", "Spider-Man", "Iron Man", "Batman", "Terminator", "Alien", "Depredador", "Jaws", "Psicosis", "Inception", "Interstellar", "Coco", "Encanto", "Moana", "Buscando a Nemo", "Los Incre√≠bles", "Shrek", "Mi Villano Favorito", "Minions", "Piratas del Caribe", "El Mago de Oz", "E.T.", "Tibbie", "Forrest Gump", "Pulp Fiction"],
            paises: ["Espa√±a", "Francia", "Italia", "Alemania", "Jap√≥n", "Brasil", "Argentina", "M√©xico", "Canad√°", "Estados Unidos", "China", "India", "Australia", "Egipto", "Grecia", "Rusia", "Inglaterra", "Portugal", "Colombia", "Per√∫", "Chile", "Uruguay", "Venezuela", "Cuba", "Corea", "Tailandia", "Vietnam", "Marruecos", "Turqu√≠a", "Noruega", "Suecia", "Finlandia", "Dinamarca", "Holanda", "B√©lgica", "Suiza", "Austria", "Irlanda", "Escocia"],
            comida: ["Tacos", "Paella", "Sushi", "Pizza", "Hamburguesa", "Lasa√±a", "Curry", "Ramen", "Ceviche", "Empanadas", "Churrasco", "Milanesa", "Feijoada", "Bandeja Paisa", "Arepa", "Patac√≥n", "Causa", "Anticuchos", "Chicha", "Pisco Sour", "Guisado", "Tamales", "Pupusas", "Chimichanga", "Enchiladas", "Tostada", "Gordita", "Quesadilla", "Burrito", "Taco", "Pasta", "Risotto", "Paella", "Tortilla", "Croissant", "Bagel", "Donut", "Cupcake", "Brownie"],
            tecnologia: ["Computadora", "Internet", "Inteligencia Artificial", "Robot", "Aplicaci√≥n", "Videojuego", "Redes Sociales", "Smartphone", "Tablet", "Wifi", "Bluetooth", "Nube", "Big Data", "Ciberseguridad", "Blockchain", "Criptomoneda", "Realidad Virtual", "Realidad Aumentada", "Drone", "Impresora 3D", "GPS", "Sensor", "Pantalla T√°ctil", "Procesador", "Memoria", "Disco Duro", "Bater√≠a", "Cargador", "Cable", "Auriculares", "Teclado", "Mouse", "C√°mara", "Micr√≥fono", "Altavoz", "Router", "M√≥dem", "Servidor", "Base de Datos"],
            deportes: ["F√∫tbol", "Baloncesto", "Tenis", "Nataci√≥n", "Atletismo", "B√©isbol", "F√∫tbol Americano", "Voleibol", "Boxeo", "Artes Marciales", "Gimnasia", "Ciclismo", "Esqu√≠", "Surf", "Escalada", "Golf", "Hockey", "Rugby", "Cr√≠quet", "Ping Pong", "B√°dminton", "Patinaje", "Lucha", "Carrera", "Marat√≥n", "Triatl√≥n", "Equitaci√≥n", "Tiro", "Arquer√≠a", "Lacrosse", "Handball", "Waterpolo", "Remo", "Pirag√ºismo", "Snowboard", "Skateboard", "BMX", "Wrestling"],
            animales: ["Le√≥n", "Tigre", "Elefante", "Jirafa", "Mono", "Conejo", "Perro", "Gato", "P√°jaro", "Pez", "Delf√≠n", "Ballena", "Tibur√≥n", "Serpiente", "Lagarto", "Rana", "Tortuga", "Cocodrilo", "Hipop√≥tamo", "Rinoceronte", "Zebra", "Caballo", "Vaca", "Cerdo", "Oveja", "Gallo", "Pato", "√Åguila", "B√∫ho", "Murci√©lago", "Lobo", "Zorro", "Oso", "Panda", "Koala", "Canguro", "Ping√ºino", "Foca", "Ballena", "Pulpo"],
            colores: ["Rojo", "Azul", "Verde", "Amarillo", "Naranja", "Morado", "Rosa", "Negro", "Blanco", "Gris", "Marr√≥n", "Beige", "Celeste", "Turquesa", "Violeta", "Lila", "Dorado", "Plateado", "Cyan", "Magenta", "Oscuro", "Claro", "Brillante", "Opaco", "Ne√≥n", "Pastel", "Matizado", "S√≥lido", "Transparente", "Opaco", "Carmes√≠", "Escarlata", "Gris√°ceo", "Azulado", "Verdoso", "Amarillento", "Anaranjado"]
        };

        let playerNames = [];
        let playerRoles = [];
        let currentIndex = 0;
        let impostorCount = 1;
        let selectedCategory = 'general';
        let timerInterval = null;
        let timeLeft = 120;
        let timerRunning = false;
        let votes = {};
        let votedPlayers = new Set();

        window.onload = () => {
            for(let i=0; i<4; i++) addPlayerInput();
        };

        function addPlayerInput() {
            const container = document.getElementById('names-container');
            const div = document.createElement('div');
            div.className = "flex gap-2";
            div.innerHTML = `
                <div class="neon-input flex-1">
                    <input type="text" placeholder="Nombre del jugador..." class="player-input">
                </div>
                <button onclick="removePlayer(this)" class="remove-btn">‚úï</button>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function removePlayer(btn) {
            const container = document.getElementById('names-container');
            if (container.children.length > 1) {
                btn.parentElement.remove();
            }
        }

        function removeLastPlayer() {
            const container = document.getElementById('names-container');
            if (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
        }

        function selectCategory(cat) {
            selectedCategory = cat;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`cat-${cat}`).classList.add('active');
        }

        function setImpostorCount(count) {
            impostorCount = count;
            document.querySelectorAll('.count-btn').forEach((btn, idx) => {
                if (idx + 1 === count) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function initGame() {
            const inputs = document.querySelectorAll('.player-input');
            playerNames = Array.from(inputs).map(i => i.value.trim()).filter(n => n !== "");

            if (playerNames.length < 3) {
                showNotification("Se necesitan al menos 3 jugadores");
                return;
            }
            if (playerNames.length > 12) {
                showNotification("M√°ximo 12 jugadores permitidos");
                return;
            }

            const words = wordBank[selectedCategory];
            const secretWord = words[Math.floor(Math.random() * words.length)];
            playerRoles = new Array(playerNames.length).fill(secretWord);
            
            let impostors = new Set();
            while(impostors.size < impostorCount) {
                impostors.add(Math.floor(Math.random() * playerNames.length));
            }
            
            impostors.forEach(idx => {
                playerRoles[idx] = { word: "IMPOSTOR üïµÔ∏è", isImpostor: true };
            });

            currentIndex = 0;
            votes = {};
            votedPlayers = new Set();
            playerNames.forEach(name => votes[name] = 0);
            
            stopTimer();
            timeLeft = 120;
            updateTimerDisplay();
            
            showScreen('screen-transition');
            updateTransitionScreen();
        }

        function updateTransitionScreen() {
            document.getElementById('current-player-name').innerText = playerNames[currentIndex].toUpperCase();
            document.getElementById('player-counter').innerText = `Jugador ${currentIndex + 1} de ${playerNames.length}`;
        }

        function revealRole() {
            const display = document.getElementById('secret-word');
            const role = playerRoles[currentIndex];
            const indicator = document.getElementById('role-indicator');
            
            if (typeof role === 'object' && role.isImpostor) {
                display.innerText = "üïµÔ∏è IMPOSTOR üïµÔ∏è";
                display.classList.add('impostor');
                indicator.classList.remove('hidden');
                indicator.className = "px-4 py-2 rounded-lg font-bold text-sm bg-red-600 text-white";
                indicator.innerText = "¬°No tienes palabra! Debes adivinar.";
            } else {
                display.innerText = role;
                display.classList.remove('impostor');
                indicator.classList.remove('hidden');
                indicator.className = "px-4 py-2 rounded-lg font-bold text-sm bg-green-600 text-white";
                indicator.innerText = "¬°No reveles tu palabra!";
            }
            
            showScreen('screen-reveal');
        }

        function nextStep() {
            document.getElementById('secret-word').classList.remove('impostor');
            currentIndex++;
            if (currentIndex < playerNames.length) {
                updateTransitionScreen();
                showScreen('screen-transition');
            } else {
                showScreen('screen-playing');
                startTimer();
            }
        }

        function showScreen(id) {
            ['screen-setup', 'screen-transition', 'screen-reveal', 'screen-playing', 'screen-voting', 'screen-results'].forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden');
        }

        function showNotification(msg) {
            const div = document.createElement('div');
            div.className = "fixed inset-0 flex items-center justify-center z-50 pointer-events-none";
            div.innerHTML = `<div class="bg-red-600 px-6 py-3 rounded-xl font-bold text-sm shadow-2xl animate-bounce">${msg}</div>`;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 2000);
        }

        // Timer functions
        function startTimer() {
            if (timerRunning) return;
            timerRunning = true;
            updateTimerBtn();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    stopTimer();
                    showNotification("¬°Tiempo agotado!");
                }
            }, 1000);
        }

        function stopTimer() {
            timerRunning = false;
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            updateTimerBtn();
        }

        function toggleTimer() {
            if (timerRunning) {
                stopTimer();
            } else {
                startTimer();
            }
        }

        function updateTimerDisplay() {
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            document.getElementById('timer-display').innerText = `${mins}:${secs.toString().padStart(2, '0')}`;
            document.getElementById('timer-bar').style.width = `${(timeLeft / 120) * 100}%`;
        }

        function updateTimerBtn() {
            const btn = document.getElementById('timer-btn');
            btn.innerText = timerRunning ? '‚è∏Ô∏è PAUSAR' : '‚ñ∂Ô∏è CONTINUAR';
        }

        // Voting functions
        function startVoting() {
            stopTimer();
            showScreen('screen-voting');
            renderVotingPlayers();
        }

        function renderVotingPlayers() {
            const container = document.getElementById('voting-players');
            container.innerHTML = '';
            
            playerNames.forEach(name => {
                const div = document.createElement('div');
                const hasVoted = votedPlayers.has(name);
                div.className = `vote-card ${hasVoted ? 'voted' : ''}`;
                div.innerHTML = `
                    <span class="font-bold">${name}</span>
                    <span class="voted-badge">${votes[name]} votos</span>
                `;
                div.onclick = () => castVote(name);
                container.appendChild(div);
            });
        }

        function castVote(forName) {
            const currentPlayer = playerNames[currentIndex];
            if (votedPlayers.has(currentPlayer)) {
                showNotification("¬°Ya votaste!");
                return;
            }
            
            votes[forName]++;
            votedPlayers.add(currentPlayer);
            renderVotingPlayers();
            showNotification(`Voto registrado para ${forName}`);
        }

        function backToGame() {
            showScreen('screen-playing');
            startTimer();
        }

        function showResults() {
            stopTimer();
            showScreen('screen-results');
            
            let maxVotes = 0;
            let eliminated = null;
            Object.entries(votes).forEach(([name, count]) => {
                if (count > maxVotes) {
                    maxVotes = count;
                    eliminated = name;
                }
            });
            
            const isImpostorEliminated = playerRoles[playerNames.indexOf(eliminated)]?.isImpostor;
            
            if (isImpostorEliminated) {
                document.getElementById('result-emoji').innerText = 'üéâ';
                document.getElementById('result-title').innerText = '¬°GANARON LOS CIUDADANOS!';
                document.getElementById('result-title').className = 'text-2xl font-black uppercase text-green-500';
                launchConfetti();
            } else {
                document.getElementById('result-emoji').innerText = 'üòà';
                document.getElementById('result-title').innerText = '¬°GANARON LOS IMPOSTORES!';
                document.getElementById('result-title').className = 'text-2xl font-black uppercase text-red-500';
            }
            
            let content = `<p class="font-bold text-white">${eliminated} fue eliminado/a</p>`;
            content += `<p class="text-slate-400 text-xs">Recibi√≥ ${maxVotes} votos</p>`;
            
            content += `<p class="font-bold text-white mt-3">Impostores:</p>`;
            playerRoles.forEach((role, idx) => {
                if (role?.isImpostor) {
                    content += `<p class="text-red-400 text-sm">üë§ ${playerNames[idx]}</p>`;
                }
            });
            
            content += `<p class="font-bold text-white mt-3">Palabra secreta:</p>`;
            const secretRoles = playerRoles.filter(r => typeof r === 'string');
            content += `<p class="text-green-400 text-sm">${secretRoles[0] || 'N/A'}</p>`;
            
            document.getElementById('result-content').innerHTML = content;
        }

        function launchConfetti() {
            const container = document.getElementById('confetti-container');
            container.innerHTML = '';
            const colors = ['#ef4444', '#f97316', '#eab308', '#22c55e', '#3b82f6', '#a855f7', '#ec4899'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.style.cssText = `
                    position: absolute;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    left: ${Math.random() * 100}%;
                    top: -20px;
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                    animation: confetti ${Math.random() * 2 + 2}s linear forwards;
                    animation-delay: ${Math.random() * 0.5}s;
                `;
                container.appendChild(confetti);
            }
            
            setTimeout(() => container.innerHTML = '', 4000);
        }

        function resetGame() {
            stopTimer();
            timeLeft = 120;
            votedPlayers.clear();
            updateTimerDisplay();
            showScreen('screen-setup');
            
            const container = document.getElementById('names-container');
            container.innerHTML = '';
            for(let i=0; i<4; i++) addPlayerInput();
        }
    </script>
</body>
</html>
